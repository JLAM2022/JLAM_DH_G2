<!DOCTYPE html>
<html>
  <head>
    <%- include('../partials/head.ejs')%>
    <title>Carrito de Compras - Terra Rossa</title>
  </head>
  <body>
    <!-- seccion barra de navegacion -->
    <header>
      <%- include('../partials/nav.ejs')%>
    </header>
    <!-- fin seccion barra de navegacion -->
    <% 
  const formatter = new Intl.NumberFormat("es-AR", { 
    style: "decimal",
    minimumFractionDigits: 2,
  }); 
  %>
    <!-- carrito de compras -->
    <section class="margin__nav">
      <h1 class="cart__title">carrito</h1>
      <div class="itemlist__container">
        <div class="cart__section">
          <div class="cart__header">
            <p>producto</p>
            <p>precio</p>
            <p>cantidad</p>
          </div>
          <% productOnCart.forEach(producto => { %>
          <div class="cart__product">
            <img src="<%producto.imagen_producto%>" alt="imagen preview del producto" />
            <div class="cart__productdetail">
              <p><span><%=producto.nombre_producto%></span></p>
              <div class="cart__buttons">
                <p>$<%= formatter.format(producto.precio)%></p>
                <form action="">
                  <select>
                    <option selected value="1">1</option>
                    <option value="3">3</option>
                    <option value="6">6</option>
                    <option value="12">12</option>
                    <option value="24">24</option>
                    <option value="48">48</option>
                  </select>
                </form>
                <form method="POST" action="/product/product-cart/<%=producto.id_producto%>?_method=DELETE">
                <button type="submit"><i class="fa-regular fa-trash-can"></i></button>
                </form>
              </div>
            </div>
          </div>
          <% })   %> 
        </div>
        <div class="cart__section--media">
          <div class="cart__minisection">
            <p>¿Tenés un código de descuento?</p>
            <div class="cart__code">
              <form action="">
                <input type="text" maxlength="8" value="Ingrese su código" />
              </form>
              <a class="cart__btn--checkout" href="">aplicar</a>
            </div>
          </div>
          <div class="cart__minisection">
            <div class="container__total">
              <div class="total__detail">
                <p>subtotal:</p>
                <% for(let i=0; i < productOnCart.length; i++){%>
                  <p>$ 
                    <%= formatter.format(productOnCart[i].precio)%></p>
                <%}%>
              </div>
              <div class="total__detail">
                <p><span>total:</span></p>
                <div>
                  <p>$<% let count = 0; for(let i=0; i < productOnCart.length; i++){%>
                    <% count = count + productOnCart[i].precio%>
                  <%}%>
                  <span><%=formatter.format(count)%></span>
                  </p>
                  <div class="total__message">
                    <p>iva no incluido</p>
                  </div>
                </div>
              </div>
              <a class="cart__btn--checkout" href="">finalizar compra</a>
              <a class="cart__btn--checkout" href="">seguir comprando</a>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- fin carrito de compras -->
    <footer class="footer">
      <%- include('../partials/footer.ejs')%>
    </footer>
  </body>
</html>
